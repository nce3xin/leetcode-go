# 最长有效括号

动态规划。

## 题目描述

给你一个只包含 '(' 和 ')' 的字符串，找出最长有效（格式正确且连续）括号子串的长度。

## dp数组定义

dp[i]表示以nums[i]为结尾的最长有效括号长度。

## 研究最后一步

dp[i]表示以nums[i]为结尾的最长有效括号长度。考虑最后一步。对于最优的策略，一定有最后一个元素s[i]。

1. 当 s[i] 为 '(', dp[i] 必然等于 0，因为不可能组成有效的括号。

2. 当 s[i] 为 ')'：

> 2.1 当 s[i-1] 为 '('，那么 dp[i] = dp[i-2] + 2。因为 s[i] 和 s[i - 1] 组成一对有效括号，有效括号长度新增长度2。

> 2.2 当 s[i-1] 为 ')'，并且 s[i-dp[i-1] - 1] 为 '('，那么 dp[i] = dp[i-1] + 2 + dp[i-dp[i-1]-2]。
> 解释：s[i] 为 ')'，则需要找到左括号和它匹配。可以跳过以下标 i-1 为结尾的合法子串长度（dp[i-1]），则需要看下标 i-dp[i-1] - 1 是否为左括号。如果没越界且为左括号，那么有 dp[i] = dp[i-1] + 2。 
> 此外在这个基础上，还要将以下标 i-dp[i-1]-2 结尾的有效括号长度加进来（只要不越界）。


时间复杂度：O(n)。

